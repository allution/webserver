define(["lib/react","lib/clib","game-logic/engine"],function(e,t,n){function s(){return{engine:n}}function o(e,t){return function(){prompt("Game "+e+" Hash: ",t)}}var r=50,i=e.DOM;return e.createClass({displayName:"gamesLog",getInitialState:function(){return s()},componentDidMount:function(){n.on({game_crash:this._onChange})},componentWillUnmount:function(){n.off({game_crash:this._onChange})},_onChange:function(){this.isMounted()&&this.setState(s())},render:function(){var e=this,n=e.state.engine.tableHistory.slice(0,r).map(function(n,r){var s,u,a,f,l=n.player_info[e.state.engine.username];l?(f=l.bonus,u=l.bet,l.stopped_at?(a=l.stopped_at/100*l.bet-l.bet,s=t.formatSatoshis(l.stopped_at)):(a=-u,s="-"),f?(a+=f,f=t.formatDecimals(f*100/u,2)+"%"):f="0%",a=t.formatSatoshis(a),u=t.formatSatoshis(u)):(s="-",u="-",a="-",f="-");var c;return n.game_crash>=198?c="games-log-goodcrash":n.game_crash<=196?c="games-log-badcrash":c="",i.tr({key:"game_"+r},i.td(null,i.a({href:"/game/"+n.game_id,target:"_blank",className:c},t.formatSatoshis(n.game_crash),i.i(null,"x"))),i.td(null,s),i.td(null,u),i.td(null,f),i.td(null,a),i.td(null,i.input({type:"input",className:"games-log-hash",readOnly:!0,value:n.hash}),i.div({className:"hash-copy-cont",onClick:o(n.game_id,n.hash)},i.span({className:"hash-copy"},i.i({className:"fa fa-clipboard"})))))});return i.table({className:"games-log"},i.thead(null,i.tr(null,i.th(null,"Crash"),i.th(null,"@"),i.th(null,"Bet"),i.th(null,"Bonus"),i.th(null,"Profit"),i.th(null,"Hash"))),i.tbody(null,n))}})});